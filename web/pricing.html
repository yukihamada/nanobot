<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pricing - chatweb.ai</title>
  <meta name="description" content="chatweb.ai pricing plans. Free, Starter $9/mo, Pro $29/mo.">
  <meta property="og:title" content="Pricing - chatweb.ai">
  <meta property="og:description" content="AI assistant pricing plans. Free, Starter ($9/mo), and Pro ($29/mo).">
  <meta property="og:image" content="https://chatweb.ai/og.svg">
  <meta property="og:url" content="https://chatweb.ai/pricing">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <style>
    :root {
      --bg: #0a0a0a;
      --surface: #141414;
      --border: #1e1e1e;
      --text: #e5e5e5;
      --muted: #777;
      --accent: #6366f1;
      --accent-hover: #818cf8;
      --green: #22c55e;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', 'Noto Sans JP', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }
    nav {
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .logo { font-size: 18px; font-weight: 700; letter-spacing: -0.5px; text-decoration: none; color: var(--text); }
    .logo span { color: var(--accent); }
    .nav-links { display: flex; align-items: center; gap: 16px; }
    .nav-links a { color: var(--muted); text-decoration: none; font-size: 14px; font-weight: 500; }
    .nav-links a:hover { color: var(--text); }
    .lang-sw {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 6px;
      overflow: hidden;
      display: flex;
    }
    .lang-sw button {
      background: none; border: none; color: var(--muted);
      padding: 4px 10px; font-size: 11px; font-weight: 600; cursor: pointer;
    }
    .lang-sw button.on { background: var(--accent); color: #fff; }

    .main {
      max-width: 960px;
      margin: 0 auto;
      padding: 40px 24px 80px;
    }
    .hero {
      text-align: center;
      margin-bottom: 48px;
    }
    .hero h1 {
      font-size: 36px;
      font-weight: 800;
      letter-spacing: -1px;
      margin-bottom: 12px;
    }
    .hero p {
      color: var(--muted);
      font-size: 16px;
      max-width: 560px;
      margin: 0 auto;
    }

    .pricing-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      margin-bottom: 48px;
    }
    .plan-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 32px 24px;
      display: flex;
      flex-direction: column;
      position: relative;
    }
    .plan-card.featured {
      border-color: var(--accent);
      box-shadow: 0 0 24px rgba(99,102,241,0.15);
    }
    .plan-badge {
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--accent);
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      padding: 4px 14px;
      border-radius: 12px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .plan-name {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    .plan-desc {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 20px;
    }
    .plan-price {
      font-size: 42px;
      font-weight: 800;
      letter-spacing: -2px;
      margin-bottom: 4px;
    }
    .plan-price .currency { font-size: 20px; font-weight: 600; }
    .plan-price .period { font-size: 14px; font-weight: 400; color: var(--muted); }
    .plan-features {
      list-style: none;
      margin: 24px 0;
      flex: 1;
    }
    .plan-features li {
      font-size: 14px;
      padding: 6px 0;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }
    .plan-features li::before {
      content: '';
      display: inline-block;
      width: 16px;
      height: 16px;
      min-width: 16px;
      margin-top: 2px;
      background: var(--green);
      border-radius: 50%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M6.5 11.5L3 8l1-1 2.5 2.5L11 5l1 1-5.5 5.5z' fill='white'/%3E%3C/svg%3E");
      background-size: 12px;
      background-repeat: no-repeat;
      background-position: center;
    }
    .plan-features li.disabled {
      color: var(--muted);
    }
    .plan-features li.disabled::before {
      background: var(--border);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath d='M4 8h8' stroke='%23555' stroke-width='1.5' fill='none'/%3E%3C/svg%3E");
      background-size: 12px;
      background-repeat: no-repeat;
      background-position: center;
    }
    .plan-cta {
      display: block;
      text-align: center;
      padding: 14px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 700;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.15s;
    }
    .plan-cta.primary {
      background: var(--accent);
      color: #fff;
    }
    .plan-cta.primary:hover { background: var(--accent-hover); transform: translateY(-1px); }
    .plan-cta.secondary {
      background: var(--surface);
      color: var(--text);
      border: 1px solid var(--border);
    }
    .plan-cta.secondary:hover { border-color: var(--accent); transform: translateY(-1px); }

    /* Coupon */
    .coupon-section {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 24px;
      margin-bottom: 24px;
      text-align: center;
    }
    .coupon-section h3 { font-size: 15px; font-weight: 700; margin-bottom: 12px; }
    .coupon-row {
      display: flex;
      gap: 8px;
      max-width: 360px;
      margin: 0 auto;
    }
    .coupon-row input {
      flex: 1;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      padding: 12px 16px;
      font-size: 15px;
      font-weight: 600;
      letter-spacing: 2px;
      text-transform: uppercase;
      outline: none;
      text-align: center;
    }
    .coupon-row input:focus { border-color: var(--accent); }
    .coupon-row input::placeholder { letter-spacing: 0; text-transform: none; font-weight: 400; color: var(--muted); }
    .coupon-row button {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s;
      white-space: nowrap;
    }
    .coupon-row button:hover { background: var(--accent-hover); }
    .coupon-msg {
      font-size: 13px;
      margin-top: 8px;
      min-height: 20px;
    }
    .coupon-msg.success { color: var(--green); }
    .coupon-msg.error { color: #ef4444; }

    /* Guarantee */
    .guarantee {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 20px;
      margin-bottom: 40px;
      background: rgba(34,197,94,0.06);
      border: 1px solid rgba(34,197,94,0.15);
      border-radius: 12px;
    }
    .guarantee svg { width: 28px; height: 28px; fill: var(--green); flex-shrink: 0; }
    .guarantee-text { text-align: left; }
    .guarantee-text strong { font-size: 14px; display: block; margin-bottom: 2px; }
    .guarantee-text span { font-size: 12px; color: var(--muted); }

    .faq { margin-bottom: 48px; }
    .faq h2 { font-size: 24px; font-weight: 800; text-align: center; margin-bottom: 24px; }
    .faq-item {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 12px;
    }
    .faq-item h3 { font-size: 15px; font-weight: 600; margin-bottom: 8px; }
    .faq-item p { font-size: 14px; color: var(--muted); line-height: 1.6; }

    footer {
      text-align: center;
      padding: 24px;
      font-size: 12px;
      color: var(--muted);
    }
    footer a { color: var(--muted); }

    /* Coupon active state â€” Starter plan highlight */
    .plan-card.coupon-active {
      border-color: #f59e0b;
      box-shadow: 0 0 32px rgba(245,158,11,0.2);
      transform: scale(1.03);
      transition: all 0.4s ease;
    }
    .plan-card.coupon-active .plan-badge {
      background: linear-gradient(135deg, #f59e0b, #d97706);
    }
    .coupon-free-badge {
      display: inline-block;
      background: linear-gradient(135deg, #f59e0b, #d97706);
      color: #fff;
      font-size: 12px;
      font-weight: 700;
      padding: 4px 12px;
      border-radius: 8px;
      margin-top: 8px;
      animation: badgePop 0.4s ease;
    }
    @keyframes badgePop {
      0% { opacity: 0; transform: scale(0.8); }
      100% { opacity: 1; transform: scale(1); }
    }
    .plan-price .original-price {
      font-size: 18px;
      color: var(--muted);
      text-decoration: line-through;
      font-weight: 400;
      margin-right: 8px;
    }
    .plan-price .trial-note {
      display: block;
      font-size: 12px;
      color: var(--muted);
      font-weight: 400;
      margin-top: 4px;
      letter-spacing: 0;
    }
    .plan-cta.green {
      background: var(--green);
      color: #fff;
    }
    .plan-cta.green:hover {
      background: #16a34a;
      transform: translateY(-1px);
    }

    @media (max-width: 768px) {
      .pricing-grid { grid-template-columns: 1fr; max-width: 400px; margin-left: auto; margin-right: auto; }
      .hero h1 { font-size: 28px; }
      #media-pricing-section > div:last-child { grid-template-columns: 1fr; max-width: 400px; margin: 0 auto; }
      #cost-calculator > div:first-of-type { grid-template-columns: 1fr; }
    }
  </style>
  <!-- PostHog Analytics (enable by replacing YOUR_PROJECT_KEY) -->
  <!--
  <script>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
    posthog.init('YOUR_PROJECT_KEY',{api_host:'https://us.i.posthog.com',person_profiles:'identified_only'});
  </script>
  -->
</head>
<body>
  <nav>
    <a href="/" class="logo"><span>chat</span>web.ai</a>
    <div class="nav-links">
      <a href="/" id="nav-home">Home</a>
      <a href="/status">Status</a>
      <a href="https://github.com/yukihamada/nanobot" target="_blank">GitHub</a>
      <div class="lang-sw">
        <button onclick="setLang('ja')" id="l-ja">JA</button>
        <button onclick="setLang('en')" id="l-en">EN</button>
      </div>
    </div>
  </nav>

  <div class="main">
    <div class="hero">
      <h1 id="t-title">æ–™é‡‘ãƒ—ãƒ©ãƒ³</h1>
      <p id="t-sub">ç„¡æ–™ã§å§‹ã‚ã¦ã€ãƒ“ã‚¸ãƒã‚¹ã®æˆé•·ã«åˆã‚ã›ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã€‚</p>
    </div>

    <div class="pricing-grid">
      <!-- Free -->
      <div class="plan-card">
        <div class="plan-name" id="p-free-name">Free</div>
        <div class="plan-desc" id="p-free-desc">å€‹äººåˆ©ç”¨ãƒ»ãŠè©¦ã—ã«</div>
        <div class="plan-price"><span class="currency">$</span>0<span class="period" id="p-free-period">/æœˆ</span></div>
        <ul class="plan-features" id="p-free-features"></ul>
        <a href="/" class="plan-cta secondary" id="p-free-cta">ä»Šã™ãä½¿ã†</a>
      </div>

      <!-- Starter -->
      <div class="plan-card featured">
        <div class="plan-badge" id="p-starter-badge">äººæ°—</div>
        <div class="plan-name" id="p-starter-name">Starter</div>
        <div class="plan-desc" id="p-starter-desc">å°è¦æ¨¡ãƒãƒ¼ãƒ ãƒ»æœ¬æ ¼åˆ©ç”¨ã«</div>
        <div class="plan-price"><span class="currency">$</span>9<span class="period" id="p-starter-period">/æœˆ</span></div>
        <ul class="plan-features" id="p-starter-features"></ul>
        <a href="#" class="plan-cta primary" id="p-starter-cta" data-plan="starter">Starterã‚’å§‹ã‚ã‚‹</a>
      </div>

      <!-- Pro -->
      <div class="plan-card">
        <div class="plan-name" id="p-pro-name">Pro</div>
        <div class="plan-desc" id="p-pro-desc">å¤§è¦æ¨¡åˆ©ç”¨ãƒ»é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã«</div>
        <div class="plan-price"><span class="currency">$</span>29<span class="period" id="p-pro-period">/æœˆ</span></div>
        <ul class="plan-features" id="p-pro-features"></ul>
        <a href="#" class="plan-cta primary" id="p-pro-cta" data-plan="pro">Proã‚’å§‹ã‚ã‚‹</a>
      </div>
    </div>

    <!-- Model Pricing Table -->
    <div id="model-pricing-section" style="margin-bottom:48px">
      <h2 style="font-size:24px;font-weight:800;text-align:center;margin-bottom:24px" id="t-model-title">LLMãƒ¢ãƒ‡ãƒ«åˆ¥æ–™é‡‘</h2>
      <div style="overflow-x:auto">
        <table style="width:100%;border-collapse:collapse;background:var(--surface);border-radius:12px;overflow:hidden">
          <thead>
            <tr style="background:rgba(99,102,241,0.1);text-align:left">
              <th style="padding:12px 16px;font-size:13px;font-weight:600">Model</th>
              <th style="padding:12px 16px;font-size:13px;font-weight:600">Provider</th>
              <th style="padding:12px 16px;font-size:13px;font-weight:600;text-align:right" id="t-input-cost">å…¥åŠ› $/1M</th>
              <th style="padding:12px 16px;font-size:13px;font-weight:600;text-align:right" id="t-output-cost">å‡ºåŠ› $/1M</th>
              <th style="padding:12px 16px;font-size:13px;font-weight:600;text-align:right" id="t-ctx-window">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
            </tr>
          </thead>
          <tbody id="model-table-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Media Generation Pricing -->
    <div id="media-pricing-section" style="margin-bottom:48px">
      <h2 style="font-size:24px;font-weight:800;text-align:center;margin-bottom:24px" id="t-media-title">ãƒ¡ãƒ‡ã‚£ã‚¢ç”Ÿæˆæ–™é‡‘</h2>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px">
        <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center">
          <div style="font-size:32px;margin-bottom:8px">ğŸ¨</div>
          <div style="font-size:16px;font-weight:700;margin-bottom:4px" id="t-img-title">ç”»åƒç”Ÿæˆ</div>
          <div style="font-size:12px;color:var(--muted);margin-bottom:16px">gpt-image-1</div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.011</span> <span style="color:var(--muted)">low</span></div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.042</span> <span style="color:var(--muted)">medium</span></div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.167</span> <span style="color:var(--muted)">high</span></div>
        </div>
        <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center">
          <div style="font-size:32px;margin-bottom:8px">ğŸµ</div>
          <div style="font-size:16px;font-weight:700;margin-bottom:4px" id="t-music-title">éŸ³æ¥½ç”Ÿæˆ</div>
          <div style="font-size:12px;color:var(--muted);margin-bottom:16px">Suno API</div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.05</span> <span style="color:var(--muted)" id="t-per-song">/æ›²</span></div>
        </div>
        <div style="background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:24px;text-align:center">
          <div style="font-size:32px;margin-bottom:8px">ğŸ¬</div>
          <div style="font-size:16px;font-weight:700;margin-bottom:4px" id="t-video-title">å‹•ç”»ç”Ÿæˆ</div>
          <div style="font-size:12px;color:var(--muted);margin-bottom:16px">Kling API</div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.10</span> <span style="color:var(--muted)">5s standard</span></div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.35</span> <span style="color:var(--muted)">5s pro</span></div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.20</span> <span style="color:var(--muted)">10s standard</span></div>
          <div style="font-size:14px"><span style="color:var(--green)">$0.70</span> <span style="color:var(--muted)">10s pro</span></div>
        </div>
      </div>
    </div>

    <!-- Cost Calculator -->
    <div id="cost-calculator" style="background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:32px;margin-bottom:48px">
      <h2 style="font-size:20px;font-weight:800;text-align:center;margin-bottom:24px" id="t-calc-title">ã‚³ã‚¹ãƒˆé›»å“</h2>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;max-width:500px;margin:0 auto 24px">
        <div>
          <label style="font-size:12px;color:var(--muted);display:block;margin-bottom:4px" id="t-calc-convos">æœˆé–“ä¼šè©±æ•°</label>
          <input type="number" id="calc-convos" value="100" min="1" max="10000" style="width:100%;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);padding:10px 14px;font-size:15px;outline:none">
        </div>
        <div>
          <label style="font-size:12px;color:var(--muted);display:block;margin-bottom:4px" id="t-calc-tokens">å¹³å‡ãƒˆãƒ¼ã‚¯ãƒ³/ä¼šè©±</label>
          <input type="number" id="calc-tokens" value="500" min="50" max="50000" step="50" style="width:100%;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);padding:10px 14px;font-size:15px;outline:none">
        </div>
      </div>
      <div>
        <label style="font-size:12px;color:var(--muted);display:block;margin-bottom:4px" id="t-calc-model">ãƒ¢ãƒ‡ãƒ«</label>
        <select id="calc-model" style="width:100%;max-width:500px;display:block;margin:0 auto 24px;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);padding:10px 14px;font-size:15px;outline:none"></select>
      </div>
      <div style="text-align:center;padding:20px;background:rgba(99,102,241,0.06);border-radius:10px;max-width:500px;margin:0 auto">
        <div style="font-size:13px;color:var(--muted);margin-bottom:4px" id="t-calc-result">æœˆé–“æ¨å®šã‚³ã‚¹ãƒˆ</div>
        <div id="calc-result" style="font-size:36px;font-weight:800;color:var(--accent);letter-spacing:-1px">$0.00</div>
        <div id="calc-detail" style="font-size:12px;color:var(--muted);margin-top:4px"></div>
      </div>
    </div>

    <!-- Coupon -->
    <div class="coupon-section">
      <h3 id="t-coupon-title">ã‚¯ãƒ¼ãƒãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ</h3>
      <div class="coupon-row">
        <input type="text" id="coupon-input" placeholder="ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›" maxlength="20" autocomplete="off">
        <button onclick="applyCoupon()" id="coupon-btn">é©ç”¨</button>
      </div>
      <div class="coupon-msg" id="coupon-msg"></div>
    </div>

    <!-- Guarantee -->
    <div class="guarantee">
      <svg viewBox="0 0 24 24"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg>
      <div class="guarantee-text">
        <strong id="t-guarantee-title">å®‰å¿ƒã®è¿”é‡‘ä¿è¨¼</strong>
        <span id="t-guarantee-desc">ã„ã¤ã§ã‚‚ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã€‚æ—¥å‰²ã‚Šè¨ˆç®—ã§è¿”é‡‘ã•ã‚Œã¾ã™ã€‚</span>
      </div>
    </div>

    <div class="faq" id="faq-section"></div>
  </div>

  <footer>
    <a href="/" id="nav-home2">Home</a> &middot;
    <a href="/status">Status</a> &middot;
    <a href="https://github.com/yukihamada/nanobot" target="_blank">GitHub</a> &middot;
    <a href="mailto:hello@chatweb.ai">Contact</a> &middot;
    chatweb.ai &copy; 2025-2026
  </footer>

  <script>
    // Region detection & pricing
    const isJP = navigator.language.startsWith('ja') ||
      Intl.DateTimeFormat().resolvedOptions().timeZone.startsWith('Asia/Tokyo');

    const PRICING = {
      jp: {
        starter: { amount: 9, currency: '$', link: 'https://buy.stripe.com/3cIdR9dUv3fQ1JufBCefC3o' },
        pro: { amount: 29, currency: '$', link: 'https://buy.stripe.com/6oU9ATaIj6s2dsc9deefC3p' },
      },
      intl: {
        starter: { amount: 19, currency: '$', link: 'https://buy.stripe.com/3cIdR9dUv3fQ1JufBCefC3o' },
        pro: { amount: 49, currency: '$', link: 'https://buy.stripe.com/6oU9ATaIj6s2dsc9deefC3p' },
      },
    };

    const region = isJP ? 'jp' : 'intl';
    const PAYMENT_LINKS = {
      starter: PRICING[region].starter.link,
      pro: PRICING[region].pro.link,
    };

    // Apply region pricing to DOM after page load
    function applyRegionPricing() {
      if (!isJP) {
        const starterPrice = document.querySelector('.plan-card.featured .plan-price');
        if (starterPrice && !starterPrice.classList.contains('coupon-modified')) {
          starterPrice.innerHTML = '<span class="currency">$</span>' + PRICING.intl.starter.amount +
            '<span class="period" id="p-starter-period">' +
            (document.documentElement.lang === 'ja' ? '/æœˆ' : '/mo') + '</span>';
        }
        const proCards = document.querySelectorAll('.plan-card:not(.featured)');
        proCards.forEach(card => {
          const name = card.querySelector('.plan-name');
          if (name && name.textContent === 'Pro') {
            const priceEl = card.querySelector('.plan-price');
            if (priceEl && !priceEl.classList.contains('coupon-modified')) {
              priceEl.innerHTML = '<span class="currency">$</span>' + PRICING.intl.pro.amount +
                '<span class="period" id="p-pro-period">' +
                (document.documentElement.lang === 'ja' ? '/æœˆ' : '/mo') + '</span>';
            }
          }
        });
      }
    }

    let activeCoupon = null;

    function applyCoupon() {
      const input = document.getElementById('coupon-input');
      const msg = document.getElementById('coupon-msg');
      const code = input.value.trim().toUpperCase();
      if (!code) return;

      // Validate coupon via API
      fetch((location.hostname === 'localhost' ? 'http://localhost:3000' : '') + '/api/v1/coupon/validate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ code: code }),
      })
      .then(r => r.json())
      .then(data => {
        if (data.valid) {
          activeCoupon = data.stripe_promo_code || code;
          msg.className = 'coupon-msg success';
          const l = document.documentElement.lang || 'ja';
          msg.textContent = l === 'ja'
            ? (data.description_ja || data.description || 'ã‚¯ãƒ¼ãƒãƒ³ãŒé©ç”¨ã•ã‚Œã¾ã—ãŸï¼')
            : (data.description || 'Coupon applied!');
          input.style.borderColor = 'var(--green)';

          // UI enhancement: highlight Starter plan with coupon details
          applyCouponUI(l, data);
        } else {
          activeCoupon = null;
          msg.className = 'coupon-msg error';
          const l = document.documentElement.lang || 'ja';
          msg.textContent = l === 'ja' ? 'ç„¡åŠ¹ãªã‚¯ãƒ¼ãƒãƒ³ã‚³ãƒ¼ãƒ‰ã§ã™' : 'Invalid coupon code';
          input.style.borderColor = '#ef4444';
          resetCouponUI();
        }
      })
      .catch(() => {
        msg.className = 'coupon-msg error';
        msg.textContent = 'Error validating coupon';
      });
    }

    document.getElementById('coupon-input').addEventListener('keydown', e => {
      if (e.key === 'Enter') applyCoupon();
    });

    function applyCouponUI(lang, data) {
      const starterCard = document.querySelector('.plan-card.featured');
      if (!starterCard) return;

      const grantCredits = data.grant_credits || 30000;
      const grantDays = data.grant_days || 30;
      const noCard = data.require_card === false;

      // Add gold border + scale
      starterCard.classList.add('coupon-active');

      // Update badge text
      const badge = document.getElementById('p-starter-badge');
      badge.textContent = lang === 'ja'
        ? (grantDays >= 180 ? '6ãƒ¶æœˆç„¡æ–™' : grantDays + 'æ—¥é–“ç„¡æ–™')
        : (grantDays >= 180 ? '6 months free' : grantDays + ' days free');

      // Update price display
      const priceEl = starterCard.querySelector('.plan-price');
      priceEl.innerHTML = '<span class="original-price">$9</span><span class="currency">$</span>0<span class="period">' +
        (lang === 'ja' ? '/æœˆ' : '/mo') + '</span>' +
        '<span class="trial-note">' +
        (lang === 'ja'
          ? (noCard ? 'ã‚«ãƒ¼ãƒ‰ç™»éŒ²ä¸è¦ãƒ»' + grantDays + 'æ—¥é–“ç„¡æ–™' : (grantDays + 1) + 'æ—¥ç›®ã‹ã‚‰$' + PRICING[region].starter.amount + '/æœˆãƒ»ã„ã¤ã§ã‚‚ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯')
          : (noCard ? 'No card required. ' + grantDays + ' days free' : 'After ' + grantDays + ' days: $' + PRICING[region].starter.amount + '/mo. Cancel anytime.')) +
        '</span>';

      // Add free badge
      if (!starterCard.querySelector('.coupon-free-badge')) {
        const freeBadge = document.createElement('div');
        freeBadge.className = 'coupon-free-badge';
        freeBadge.textContent = lang === 'ja'
          ? (noCard ? 'ã‚«ãƒ¼ãƒ‰ä¸è¦ï¼' + grantDays + 'æ—¥é–“ å®Œå…¨ç„¡æ–™' : grantDays + 'æ—¥é–“ å®Œå…¨ç„¡æ–™')
          : (noCard ? 'No card needed! ' + grantDays + ' days free' : grantDays + ' days completely free');
        priceEl.parentNode.insertBefore(freeBadge, priceEl.nextSibling);
      }

      // Update CTA button â€” if no card required, redeem directly
      const cta = document.getElementById('p-starter-cta');
      if (noCard) {
        cta.textContent = lang === 'ja' ? 'ä»Šã™ãç„¡æ–™ã§å§‹ã‚ã‚‹' : 'Start free now';
        cta.classList.remove('primary');
        cta.classList.add('green');
        cta.dataset.nocard = 'true';
      } else {
        cta.textContent = lang === 'ja' ? 'ä»Šã™ãç„¡æ–™ã§å§‹ã‚ã‚‹' : 'Start free now';
        cta.classList.remove('primary');
        cta.classList.add('green');
      }
    }

    function resetCouponUI() {
      const starterCard = document.querySelector('.plan-card.featured');
      if (!starterCard) return;

      starterCard.classList.remove('coupon-active');

      // Restore badge
      const l = document.documentElement.lang || 'ja';
      document.getElementById('p-starter-badge').textContent = T[l].badge;

      // Restore price
      const priceEl = starterCard.querySelector('.plan-price');
      priceEl.innerHTML = '<span class="currency">$</span>9<span class="period" id="p-starter-period">' +
        T[l].starter.period + '</span>';

      // Remove free badge
      const freeBadge = starterCard.querySelector('.coupon-free-badge');
      if (freeBadge) freeBadge.remove();

      // Restore CTA
      const cta = document.getElementById('p-starter-cta');
      cta.textContent = T[l].starter.cta;
      cta.classList.remove('green');
      cta.classList.add('primary');
    }

    const T = {
      ja: {
        title: 'æ–™é‡‘ãƒ—ãƒ©ãƒ³',
        sub: 'ç„¡æ–™ã§å§‹ã‚ã¦ã€ãƒ“ã‚¸ãƒã‚¹ã®æˆé•·ã«åˆã‚ã›ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã€‚',
        navHome: 'ãƒ›ãƒ¼ãƒ ',
        badge: 'äººæ°—',
        free: { name: 'Free', desc: 'å€‹äººåˆ©ç”¨ãƒ»ãŠè©¦ã—ã«', cta: 'ä»Šã™ãä½¿ã†', period: '/æœˆ' },
        starter: { name: 'Starter', desc: 'å°è¦æ¨¡ãƒãƒ¼ãƒ ãƒ»æœ¬æ ¼åˆ©ç”¨ã«', cta: 'Starterã‚’å§‹ã‚ã‚‹', period: '/æœˆ' },
        pro: { name: 'Pro', desc: 'å¤§è¦æ¨¡åˆ©ç”¨ãƒ»é«˜æ€§èƒ½ãƒ¢ãƒ‡ãƒ«ã«', cta: 'Proã‚’å§‹ã‚ã‚‹', period: '/æœˆ' },
        features: {
          free: [
            '1,000 ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ',
            '5 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†',
            'GPT-4o-mini, Gemini Flash',
            '100 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ/æœˆ',
            'Webãƒ»LINEãƒ»Telegramå¯¾å¿œ',
          ],
          starter: [
            '25,000 ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ',
            '30 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†',
            'GPT-4o-mini, Gemini Flash',
            '+ GPT-4o, Claude Sonnet',
            '2,000 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ/æœˆ',
            'Webãƒ»LINEãƒ»Telegramå¯¾å¿œ',
            'å„ªå…ˆã‚µãƒãƒ¼ãƒˆ',
          ],
          pro: [
            '300,000 ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ/æœˆ',
            '120 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†',
            'å…¨ãƒ¢ãƒ‡ãƒ«åˆ©ç”¨å¯èƒ½',
            '+ Claude Opus',
            '20,000 ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡Œ/æœˆ',
            'Webãƒ»LINEãƒ»Telegramå¯¾å¿œ',
            'å„ªå…ˆã‚µãƒãƒ¼ãƒˆ',
            'ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ',
          ],
        },
        couponTitle: 'ã‚¯ãƒ¼ãƒãƒ³ã‚³ãƒ¼ãƒ‰ã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ',
        couponBtn: 'é©ç”¨',
        couponPh: 'ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›',
        guaranteeTitle: 'å®‰å¿ƒã®è¿”é‡‘ä¿è¨¼',
        guaranteeDesc: 'ã„ã¤ã§ã‚‚ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã€‚æ—¥å‰²ã‚Šè¨ˆç®—ã§è¿”é‡‘ã•ã‚Œã¾ã™ã€‚',
        faqTitle: 'ã‚ˆãã‚ã‚‹è³ªå•',
        faqs: [
          { q: 'ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ', a: 'ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã¯APIã®åˆ©ç”¨é‡ã‚’è¡¨ã™å˜ä½ã§ã™ã€‚ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦æ¶ˆè²»é‡ãŒç•°ãªã‚Šã¾ã™ã€‚GPT-4o-miniã¯1Kå…¥åŠ›ãƒˆãƒ¼ã‚¯ãƒ³ã§1ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€Claude Opusã¯30ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã§ã™ã€‚' },
          { q: 'ãƒ—ãƒ©ãƒ³ã¯ã„ã¤ã§ã‚‚å¤‰æ›´ã§ãã¾ã™ã‹ï¼Ÿ', a: 'ã¯ã„ã€ã„ã¤ã§ã‚‚ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒ»ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ãŒå¯èƒ½ã§ã™ã€‚ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã¯å³åº§ã«åæ˜ ã•ã‚Œã€å·®é¡ãŒæ—¥å‰²ã‚Šè¨ˆç®—ã•ã‚Œã¾ã™ã€‚' },
          { q: 'ç„¡æ–™ãƒ—ãƒ©ãƒ³ã«åˆ¶é™ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', a: 'ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ã¯æœˆ1,000ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã€åˆ†5ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§åˆ©ç”¨å¯èƒ½ã§ã™ã€‚GPT-4o-miniã¨Gemini Flashãƒ¢ãƒ‡ãƒ«ãŒä½¿ãˆã¾ã™ã€‚' },
          { q: 'æ”¯æ‰•ã„æ–¹æ³•ã¯ä½•ãŒä½¿ãˆã¾ã™ã‹ï¼Ÿ', a: 'Stripeã‚’é€šã˜ã¦Visaã€Mastercardã€American Expressã€JCBãªã©ä¸»è¦ãªã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã¨ãƒ‡ãƒ“ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚' },
        ],
      },
      en: {
        title: 'Pricing',
        sub: 'Start free, scale as your business grows.',
        navHome: 'Home',
        badge: 'Popular',
        free: { name: 'Free', desc: 'For personal use & trial', cta: 'Get Started', period: '/mo' },
        starter: { name: 'Starter', desc: 'For small teams & serious use', cta: 'Start Starter', period: '/mo' },
        pro: { name: 'Pro', desc: 'For high-volume & advanced models', cta: 'Start Pro', period: '/mo' },
        features: {
          free: [
            '1,000 credits/mo',
            '5 requests/min',
            'GPT-4o-mini, Gemini Flash',
            '100 agent runs/mo',
            'Web, LINE & Telegram',
          ],
          starter: [
            '25,000 credits/mo',
            '30 requests/min',
            'GPT-4o-mini, Gemini Flash',
            '+ GPT-4o, Claude Sonnet',
            '2,000 agent runs/mo',
            'Web, LINE & Telegram',
            'Priority support',
          ],
          pro: [
            '300,000 credits/mo',
            '120 requests/min',
            'All models available',
            '+ Claude Opus',
            '20,000 agent runs/mo',
            'Web, LINE & Telegram',
            'Priority support',
            'Custom agents',
          ],
        },
        couponTitle: 'Have a coupon code?',
        couponBtn: 'Apply',
        couponPh: 'Enter code',
        guaranteeTitle: 'Money-back guarantee',
        guaranteeDesc: 'Cancel anytime. Prorated refunds, no questions asked.',
        faqTitle: 'FAQ',
        faqs: [
          { q: 'What are credits?', a: 'Credits measure API usage. Different models consume different amounts. GPT-4o-mini costs 1 credit per 1K input tokens, while Claude Opus costs 30 credits.' },
          { q: 'Can I change plans anytime?', a: 'Yes, you can upgrade or downgrade anytime. Upgrades take effect immediately with prorated billing.' },
          { q: 'Are there limits on the free plan?', a: 'The free plan includes 1,000 credits/month and 5 requests/minute. You can use GPT-4o-mini and Gemini Flash models.' },
          { q: 'What payment methods are accepted?', a: 'We accept Visa, Mastercard, American Express, JCB and other major credit/debit cards via Stripe.' },
        ],
      },
    };

    function renderFeatures(planKey, features) {
      const el = document.getElementById('p-' + planKey + '-features');
      el.innerHTML = '';
      features.forEach(f => {
        const li = document.createElement('li');
        li.textContent = f;
        el.appendChild(li);
      });
    }

    function renderFaq(lang) {
      const t = T[lang];
      const section = document.getElementById('faq-section');
      let html = '<h2>' + t.faqTitle + '</h2>';
      t.faqs.forEach(faq => {
        html += '<div class="faq-item"><h3>' + faq.q + '</h3><p>' + faq.a + '</p></div>';
      });
      section.innerHTML = html;
    }

    function setLang(l) {
      document.documentElement.lang = l;
      localStorage.setItem('nl', l);
      document.getElementById('l-ja').className = l === 'ja' ? 'on' : '';
      document.getElementById('l-en').className = l === 'en' ? 'on' : '';

      const t = T[l];
      document.getElementById('t-title').textContent = t.title;
      document.getElementById('t-sub').textContent = t.sub;
      document.getElementById('nav-home').textContent = t.navHome;
      document.getElementById('nav-home2').textContent = t.navHome;
      document.getElementById('p-starter-badge').textContent = t.badge;

      ['free', 'starter', 'pro'].forEach(p => {
        document.getElementById('p-' + p + '-name').textContent = t[p].name;
        document.getElementById('p-' + p + '-desc').textContent = t[p].desc;
        document.getElementById('p-' + p + '-cta').textContent = t[p].cta;
        document.getElementById('p-' + p + '-period').textContent = t[p].period;
        renderFeatures(p, t.features[p]);
      });

      document.getElementById('t-coupon-title').textContent = t.couponTitle;
      document.getElementById('coupon-btn').textContent = t.couponBtn;
      document.getElementById('coupon-input').placeholder = t.couponPh;
      document.getElementById('t-guarantee-title').textContent = t.guaranteeTitle;
      document.getElementById('t-guarantee-desc').textContent = t.guaranteeDesc;
      renderFaq(l);
    }

    // CTA clicks â€” apply coupon if active
    document.querySelectorAll('[data-plan]').forEach(btn => {
      btn.addEventListener('click', function(e) {
        e.preventDefault();
        const plan = this.dataset.plan;

        // No-card coupon: redeem directly via API
        if (this.dataset.nocard === 'true' && activeCoupon) {
          const sid = localStorage.getItem('session_id') || '';
          const token = localStorage.getItem('auth_token') || '';
          const headers = { 'Content-Type': 'application/json' };
          if (token) headers['Authorization'] = 'Bearer ' + token;

          this.disabled = true;
          const lang = document.documentElement.lang || 'ja';
          this.textContent = lang === 'ja' ? 'é©ç”¨ä¸­...' : 'Applying...';

          fetch('/api/v1/coupon/redeem', {
            method: 'POST',
            headers: headers,
            body: JSON.stringify({ code: activeCoupon, session_id: sid }),
          })
          .then(r => r.json())
          .then(data => {
            if (data.success) {
              const msg = document.getElementById('coupon-msg');
              msg.className = 'coupon-msg success';
              msg.textContent = lang === 'ja'
                ? data.message_ja || 'ã‚¯ãƒ¼ãƒãƒ³é©ç”¨å®Œäº†ï¼'
                : data.message || 'Coupon redeemed!';
              this.textContent = lang === 'ja' ? 'é©ç”¨æ¸ˆã¿ï¼ãƒãƒ£ãƒƒãƒˆã¸' : 'Done! Go to chat';
              this.classList.add('green');
              setTimeout(() => { window.location.href = '/'; }, 1500);
            } else {
              const msg = document.getElementById('coupon-msg');
              msg.className = 'coupon-msg error';
              msg.textContent = lang === 'ja'
                ? (data.error_ja || data.error || 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ')
                : (data.error || 'Error redeeming coupon');
              this.disabled = false;
              this.textContent = lang === 'ja' ? 'ä»Šã™ãç„¡æ–™ã§å§‹ã‚ã‚‹' : 'Start free now';
            }
          })
          .catch(() => {
            this.disabled = false;
            this.textContent = lang === 'ja' ? 'ä»Šã™ãç„¡æ–™ã§å§‹ã‚ã‚‹' : 'Start free now';
            alert(lang === 'ja' ? 'ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚' : 'Error. Please try again.');
          });
          return;
        }

        // API-based Stripe Checkout
        fetch('/api/v1/billing/checkout', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ plan: plan, coupon: activeCoupon }),
        })
        .then(r => r.json())
        .then(d => {
          if (d.checkout_url) {
            window.location.href = d.checkout_url;
          } else {
            alert(d.error || (lang === 'ja' ? 'æ±ºæ¸ˆãƒšãƒ¼ã‚¸ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ' : 'Failed to create checkout'));
          }
        })
        .catch(() => alert(lang === 'ja' ? 'æ±ºæ¸ˆãƒšãƒ¼ã‚¸ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚' : 'Error creating checkout. Please try again.'));
      });
    });

    // Model pricing data (kept in sync with pricing.rs)
    const MODEL_PRICING = [
      { model: 'gpt-4o',          provider: 'OpenAI',    input: 2.50,  output: 10.00, ctx: 128000 },
      { model: 'gpt-4o-mini',     provider: 'OpenAI',    input: 0.15,  output: 0.60,  ctx: 128000 },
      { model: 'gpt-4.1',         provider: 'OpenAI',    input: 2.00,  output: 8.00,  ctx: 1048576 },
      { model: 'gpt-4.1-mini',    provider: 'OpenAI',    input: 0.40,  output: 1.60,  ctx: 1048576 },
      { model: 'gpt-4.1-nano',    provider: 'OpenAI',    input: 0.10,  output: 0.40,  ctx: 1048576 },
      { model: 'claude-sonnet-4-5', provider: 'Anthropic', input: 3.00,  output: 15.00, ctx: 200000 },
      { model: 'claude-haiku-3-5',  provider: 'Anthropic', input: 1.00,  output: 5.00,  ctx: 200000 },
      { model: 'claude-opus-4-5',   provider: 'Anthropic', input: 5.00,  output: 25.00, ctx: 200000 },
      { model: 'gemini-2.5-flash',  provider: 'Google',   input: 0.15,  output: 0.60,  ctx: 1048576 },
      { model: 'gemini-2.0-flash',  provider: 'Google',   input: 0.10,  output: 0.40,  ctx: 1048576 },
      { model: 'llama-3.3-70b',     provider: 'Groq',     input: 0.59,  output: 0.79,  ctx: 128000 },
    ];

    function renderModelTable() {
      const tbody = document.getElementById('model-table-body');
      tbody.innerHTML = MODEL_PRICING.map(m =>
        '<tr style="border-top:1px solid var(--border)">' +
        '<td style="padding:10px 16px;font-size:13px;font-weight:600">' + m.model + '</td>' +
        '<td style="padding:10px 16px;font-size:13px;color:var(--muted)">' + m.provider + '</td>' +
        '<td style="padding:10px 16px;font-size:13px;text-align:right;color:var(--green)">$' + m.input.toFixed(2) + '</td>' +
        '<td style="padding:10px 16px;font-size:13px;text-align:right;color:var(--green)">$' + m.output.toFixed(2) + '</td>' +
        '<td style="padding:10px 16px;font-size:13px;text-align:right">' + (m.ctx >= 1000000 ? (m.ctx/1000000).toFixed(0)+'M' : (m.ctx/1000)+'K') + '</td>' +
        '</tr>'
      ).join('');
    }

    function renderCalcModelSelect() {
      const sel = document.getElementById('calc-model');
      sel.innerHTML = MODEL_PRICING.map(m =>
        '<option value="' + m.model + '">' + m.model + ' (' + m.provider + ') â€” $' + m.input + '/$' + m.output + '</option>'
      ).join('');
    }

    function updateCalcResult() {
      const convos = parseInt(document.getElementById('calc-convos').value) || 100;
      const tokensPerConvo = parseInt(document.getElementById('calc-tokens').value) || 500;
      const modelName = document.getElementById('calc-model').value;
      const m = MODEL_PRICING.find(p => p.model === modelName) || MODEL_PRICING[0];
      const totalTokens = convos * tokensPerConvo;
      // Assume 60% input, 40% output
      const inputTokens = totalTokens * 0.6;
      const outputTokens = totalTokens * 0.4;
      const cost = (inputTokens / 1000000) * m.input + (outputTokens / 1000000) * m.output;
      document.getElementById('calc-result').textContent = '$' + cost.toFixed(2);
      const l = document.documentElement.lang || 'ja';
      document.getElementById('calc-detail').textContent = l === 'ja'
        ? (totalTokens.toLocaleString() + ' tokens/æœˆ Ã— ' + m.model)
        : (totalTokens.toLocaleString() + ' tokens/mo Ã— ' + m.model);
    }

    renderModelTable();
    renderCalcModelSelect();
    updateCalcResult();
    document.getElementById('calc-convos').addEventListener('input', updateCalcResult);
    document.getElementById('calc-tokens').addEventListener('input', updateCalcResult);
    document.getElementById('calc-model').addEventListener('change', updateCalcResult);

    setLang(localStorage.getItem('nl') || (navigator.language.startsWith('ja') ? 'ja' : 'en'));
    applyRegionPricing();

    // ğŸ® Konami Code Easter Egg - for users who gave feedback
    (function() {
      const konamiCode = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
      let konamiIndex = 0;

      document.addEventListener('keydown', function(e) {
        const key = e.key === 'b' || e.key === 'a' ? e.key : e.code;

        if (key === konamiCode[konamiIndex]) {
          konamiIndex++;
          if (konamiIndex === konamiCode.length) {
            konamiIndex = 0;
            activateKonamiReward();
          }
        } else {
          konamiIndex = 0;
        }
      });

      function activateKonamiReward() {
        const lang = document.documentElement.lang || 'ja';
        const msg = lang === 'ja'
          ? 'ğŸ‰ ç§˜å¯†ã®ã‚³ãƒãƒ³ãƒ‰ç™ºå‹•ï¼\n\nãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚ã‚ŠãŒã¨ã†ï¼\nç‰¹åˆ¥ã«1000ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆğŸ\n\nã‚¯ãƒ¼ãƒãƒ³ã‚³ãƒ¼ãƒ‰: KONAMI2026\n\nï¼ˆç™»éŒ²æ™‚ã«å…¥åŠ›ã—ã¦ã­ï¼‰'
          : 'ğŸ‰ Secret Code Activated!\n\nThanks for your feedback!\nHere\'s 1000 bonus creditsğŸ\n\nCoupon: KONAMI2026\n\n(Enter at signup)';

        alert(msg);

        // Copy coupon to clipboard
        if (navigator.clipboard) {
          navigator.clipboard.writeText('KONAMI2026');
        }

        // Visual celebration
        document.body.style.animation = 'rainbow 2s infinite';
        setTimeout(() => {
          document.body.style.animation = '';
        }, 5000);
      }

      // Add rainbow animation
      const style = document.createElement('style');
      style.textContent = `
        @keyframes rainbow {
          0% { filter: hue-rotate(0deg); }
          100% { filter: hue-rotate(360deg); }
        }
      `;
      document.head.appendChild(style);
    })();
  </script>
</body>
</html>
