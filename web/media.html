<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIãƒ¡ãƒ‡ã‚£ã‚¢ç”Ÿæˆ - ç”»åƒãƒ»éŸ³å£°ãƒ»å‹•ç”»ã‚’ç°¡å˜ä½œæˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', YuGothic, Meiryo, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 36px;
            color: #333;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f0f0f0;
        }
        
        .card-icon {
            font-size: 48px;
            margin-right: 15px;
        }
        
        .card-title {
            flex: 1;
        }
        
        .card-title h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 5px;
        }
        
        .card-title p {
            color: #888;
            font-size: 14px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .label-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            margin-left: 8px;
            font-weight: normal;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 15px;
            transition: border-color 0.3s, box-shadow 0.3s;
            font-family: inherit;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
            line-height: 1.6;
        }
        
        .sample-prompts {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .sample-prompt {
            background: #f5f5f5;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #e0e0e0;
        }
        
        .sample-prompt:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        button {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        button:active:not(:disabled) {
            transform: translateY(0);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .loading {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 12px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
        }
        
        .result.success {
            background: #d4edda;
            border-left-color: #28a745;
        }
        
        .result.error {
            background: #f8d7da;
            border-left-color: #dc3545;
        }
        
        .result-content {
            margin-top: 15px;
        }
        
        .generated-image {
            width: 100%;
            border-radius: 12px;
            margin-top: 15px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        audio {
            width: 100%;
            margin-top: 15px;
        }
        
        .download-btn {
            display: inline-block;
            margin-top: 15px;
            padding: 10px 20px;
            background: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .download-btn:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }
        
        .info-box {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 4px solid #2196f3;
        }
        
        .info-box h3 {
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .info-box p {
            color: #555;
            line-height: 1.8;
            font-size: 14px;
        }
        
        .info-box code {
            background: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
        }
        
        .token-input {
            position: relative;
        }
        
        .token-toggle {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            width: auto;
            padding: 5px;
        }
        
        .credits-info {
            display: inline-block;
            background: #fff3cd;
            color: #856404;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
            margin-top: 8px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 28px;
            }
            
            .card {
                padding: 20px;
            }
            
            .card-icon {
                font-size: 36px;
            }
            
            .card-title h2 {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¨ AIãƒ¡ãƒ‡ã‚£ã‚¢ç”Ÿæˆ</h1>
            <p>ç”»åƒãƒ»éŸ³å£°ãƒ»å‹•ç”»ã‚’ç°¡å˜ã«ä½œæˆã§ãã¾ã™</p>
        </div>

        <div class="info-box">
            <h3>ğŸ“– ä½¿ã„æ–¹</h3>
            <p>
                <strong>ã‚¹ãƒ†ãƒƒãƒ—1:</strong> <a href="https://chatweb.ai" target="_blank">chatweb.ai</a> ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™<br>
                <strong>ã‚¹ãƒ†ãƒƒãƒ—2:</strong> ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ« (F12) ã‚’é–‹ãã€Console ã§ <code>localStorage.getItem('auth_token')</code> ã‚’å®Ÿè¡Œ<br>
                <strong>ã‚¹ãƒ†ãƒƒãƒ—3:</strong> è¡¨ç¤ºã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ä¸‹ã®ã€Œèªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã€æ¬„ã«è²¼ã‚Šä»˜ã‘ã¾ã™<br>
                <strong>ã‚¹ãƒ†ãƒƒãƒ—4:</strong> å¥½ããªãƒ¡ãƒ‡ã‚£ã‚¢ã‚’ç”Ÿæˆï¼
            </p>
        </div>

        <!-- èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ”‘</div>
                <div class="card-title">
                    <h2>èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³</h2>
                    <p>ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«å–å¾—ã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›</p>
                </div>
            </div>
            <div class="form-group token-input">
                <input type="password" id="authToken" placeholder="Bearer token ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„">
                <button type="button" class="token-toggle" onclick="toggleTokenVisibility()">ğŸ‘ï¸</button>
            </div>
        </div>

        <!-- TTS -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ”Š</div>
                <div class="card-title">
                    <h2>éŸ³å£°ç”Ÿæˆ (Text-to-Speech)</h2>
                    <p>ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªç„¶ãªéŸ³å£°ã«å¤‰æ›</p>
                </div>
            </div>
            
            <div class="form-group">
                <label>èª­ã¿ä¸Šã’ã‚‹ãƒ†ã‚­ã‚¹ãƒˆ</label>
                <textarea id="ttsText" placeholder="ä¾‹: ã“ã‚“ã«ã¡ã¯ã€ä»Šæ—¥ã¯ã„ã„å¤©æ°—ã§ã™ã­">ã“ã‚“ã«ã¡ã¯ã€ã“ã‚Œã¯AIéŸ³å£°ç”Ÿæˆã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚è‡ªç„¶ãªæ—¥æœ¬èªã§èª­ã¿ä¸Šã’ã¾ã™ã€‚</textarea>
                <div class="sample-prompts">
                    <div class="sample-prompt" onclick="setTTSText('ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™ã€‚ä»Šæ—¥ã‚‚è‰¯ã„ä¸€æ—¥ã‚’ãŠéã”ã—ãã ã•ã„ã€‚')">ãŠã¯ã‚ˆã†æŒ¨æ‹¶</div>
                    <div class="sample-prompt" onclick="setTTSText('ã”æ³¨æ–‡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚å•†å“ã¯3å–¶æ¥­æ—¥ä»¥å†…ã«ç™ºé€ã„ãŸã—ã¾ã™ã€‚')">ãƒ“ã‚¸ãƒã‚¹</div>
                    <div class="sample-prompt" onclick="setTTSText('ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã¯ä½•ã‚’ã—ã¦éŠã¼ã†ã‹ãªï¼Ÿ')">å­ä¾›å‘ã‘</div>
                </div>
            </div>

            <div class="form-group">
                <label>éŸ³å£° <span class="label-badge">è‡ªå‹•ã§æœ€é©ãªå£°ã‚’é¸æŠ</span></label>
                <select id="ttsVoice">
                    <option value="Kazuha">Kazuha (æ—¥æœ¬èªãƒ»å¥³æ€§) æ¨å¥¨</option>
                    <option value="Takumi">Takumi (æ—¥æœ¬èªãƒ»ç”·æ€§)</option>
                    <option value="Mizuki">Mizuki (æ—¥æœ¬èªãƒ»å¥³æ€§)</option>
                    <option value="nova">Nova (è‹±èªãƒ»å¥³æ€§)</option>
                </select>
                <div class="credits-info">ğŸ’° ç´„ 1 credit / 100æ–‡å­—</div>
            </div>

            <button onclick="generateTTS()" id="ttsBtn">ğŸ”Š éŸ³å£°ã‚’ç”Ÿæˆã™ã‚‹</button>
            <div id="ttsResult"></div>
        </div>

        <!-- Image Generation -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ–¼ï¸</div>
                <div class="card-title">
                    <h2>ç”»åƒç”Ÿæˆ (AI Image)</h2>
                    <p>ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ç¾ã—ã„ç”»åƒã‚’ä½œæˆ</p>
                </div>
            </div>

            <div class="form-group">
                <label>ç”»åƒã®èª¬æ˜ <span class="label-badge">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</span></label>
                <textarea id="imagePrompt" placeholder="ä¾‹: é›ªã®ä¸­ã«åº§ã£ã¦ã„ã‚‹å¯æ„›ã„çŒ«ã€ã‚·ãƒãƒãƒ†ã‚£ãƒƒã‚¯ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°">é›ªã®ä¸­ã«åº§ã£ã¦ã„ã‚‹å¯æ„›ã„çŒ«ã€æœˆå…‰ã®ä¸‹ã€ã‚·ãƒãƒãƒ†ã‚£ãƒƒã‚¯ãƒ©ã‚¤ãƒ†ã‚£ãƒ³ã‚°ã€4Kå“è³ªã€ãƒ•ã‚©ãƒˆãƒªã‚¢ãƒ«</textarea>
                <div class="sample-prompts">
                    <div class="sample-prompt" onclick="setImagePrompt('ç¾ã—ã„æ—¥æœ¬åº­åœ’ã€æ¡œãŒæº€é–‹ã€æ˜¥ã®æœã€æŸ”ã‚‰ã‹ã„å…‰')">æ—¥æœ¬åº­åœ’</div>
                    <div class="sample-prompt" onclick="setImagePrompt('æœªæ¥éƒ½å¸‚ã®å¤œæ™¯ã€ãƒã‚ªãƒ³ãƒ©ã‚¤ãƒˆã€ã‚µã‚¤ãƒãƒ¼ãƒ‘ãƒ³ã‚¯')">æœªæ¥éƒ½å¸‚</div>
                    <div class="sample-prompt" onclick="setImagePrompt('å®‡å®™é£›è¡Œå£«ãŒæœˆé¢ã‚’æ­©ãã€åœ°çƒãŒè¦‹ãˆã‚‹ã€ãƒªã‚¢ãƒ«')">å®‡å®™</div>
                    <div class="sample-prompt" onclick="setImagePrompt('å¯æ„›ã„æŸ´çŠ¬ã®å­çŠ¬ã€è‰åŸã§éŠã¶ã€æ™´å¤©')">æŸ´çŠ¬</div>
                </div>
            </div>

            <div class="form-group">
                <label>ãƒ¢ãƒ‡ãƒ« <span class="label-badge">å“è³ªã¨é€Ÿåº¦</span></label>
                <select id="imageModel" onchange="updateImageCredits()">
                    <option value="flux-schnell">Flux Schnell (é«˜é€Ÿãƒ»5 credits) æ¨å¥¨</option>
                    <option value="flux-pro">Flux Pro (æœ€é«˜å“è³ªãƒ»15 credits)</option>
                    <option value="flux-realism">Flux Realism (è¶…ãƒªã‚¢ãƒ«ãƒ»10 credits)</option>
                </select>
            </div>

            <div class="form-group">
                <label>ã‚µã‚¤ã‚º</label>
                <select id="imageSize">
                    <option value="1024x1024">æ­£æ–¹å½¢ (1024Ã—1024)</option>
                    <option value="1792x1024">æ¨ªé•· (1792Ã—1024)</option>
                    <option value="1024x1792">ç¸¦é•· (1024Ã—1792)</option>
                </select>
                <div class="credits-info" id="imageCredits">ğŸ’° 5 credits</div>
            </div>

            <button onclick="generateImage()" id="imageBtn">ğŸ–¼ï¸ ç”»åƒã‚’ç”Ÿæˆã™ã‚‹</button>
            <div id="imageResult"></div>
        </div>

        <!-- Video Generation -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">ğŸ¬</div>
                <div class="card-title">
                    <h2>å‹•ç”»ç”Ÿæˆ (AI Video)</h2>
                    <p>ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰çŸ­ã„å‹•ç”»ã‚’ä½œæˆ</p>
                </div>
            </div>

            <div class="form-group">
                <label>å‹•ç”»ã®èª¬æ˜ <span class="label-badge">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</span></label>
                <textarea id="videoPrompt" placeholder="ä¾‹: ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ãŒãƒ“ãƒ¼ãƒã§èµ°ã‚‹ã€å¤•æš®ã‚Œ">ã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ãƒ¬ãƒˆãƒªãƒãƒ¼ãŒå¹¸ã›ãã†ã«ãƒ“ãƒ¼ãƒã‚’èµ°ã‚‹ã€å¤•æš®ã‚Œæ™‚ã€ã‚¹ãƒ­ãƒ¼ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚·ãƒãƒãƒ†ã‚£ãƒƒã‚¯</textarea>
                <div class="sample-prompts">
                    <div class="sample-prompt" onclick="setVideoPrompt('æ¡œã®èŠ±ã³ã‚‰ãŒé¢¨ã«èˆã†ã€æ˜¥ã®å…¬åœ’ã€ã‚¹ãƒ­ãƒ¼ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³')">æ¡œ</div>
                    <div class="sample-prompt" onclick="setVideoPrompt('æ³¢ãŒç ‚æµœã«æ‰“ã¡å¯„ã›ã‚‹ã€é’ã„æµ·ã€ãƒªãƒ©ãƒƒã‚¯ã‚¹')">æµ·</div>
                    <div class="sample-prompt" onclick="setVideoPrompt('çŒ«ãŒã‚¸ãƒ£ãƒ³ãƒ—ã™ã‚‹ã€ã‚¹ãƒ­ãƒ¼ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã€å¯æ„›ã„')">çŒ«ã‚¸ãƒ£ãƒ³ãƒ—</div>
                </div>
            </div>

            <div class="form-group">
                <label>é•·ã• <span class="label-badge">ç”Ÿæˆæ™‚é–“: ç´„2-3åˆ†</span></label>
                <select id="videoDuration" onchange="updateVideoCredits()">
                    <option value="5">5ç§’ (50 credits) æ¨å¥¨</option>
                    <option value="10">10ç§’ (100 credits)</option>
                </select>
                <div class="credits-info" id="videoCredits">ğŸ’° 50 credits</div>
            </div>

            <button onclick="generateVideo()" id="videoBtn">ğŸ¬ å‹•ç”»ã‚’ç”Ÿæˆã™ã‚‹</button>
            <div id="videoResult"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'https://api.chatweb.ai/api/v1/media';

        window.addEventListener('load', () => {
            const savedToken = localStorage.getItem('auth_token') || localStorage.getItem('test_auth_token');
            if (savedToken) {
                document.getElementById('authToken').value = savedToken;
            }
        });

        function toggleTokenVisibility() {
            const input = document.getElementById('authToken');
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        document.getElementById('authToken').addEventListener('change', (e) => {
            if (e.target.value.trim()) {
                localStorage.setItem('test_auth_token', e.target.value.trim());
            }
        });

        function setTTSText(text) {
            document.getElementById('ttsText').value = text;
        }

        function setImagePrompt(prompt) {
            document.getElementById('imagePrompt').value = prompt;
        }

        function setVideoPrompt(prompt) {
            document.getElementById('videoPrompt').value = prompt;
        }

        function updateImageCredits() {
            const model = document.getElementById('imageModel').value;
            const credits = {
                'flux-schnell': 5,
                'flux-pro': 15,
                'flux-realism': 10
            };
            document.getElementById('imageCredits').textContent = `ğŸ’° ${credits[model]} credits`;
        }

        function updateVideoCredits() {
            const duration = document.getElementById('videoDuration').value;
            const credits = duration === '5' ? 50 : 100;
            document.getElementById('videoCredits').textContent = `ğŸ’° ${credits} credits`;
        }

        async function generateTTS() {
            const btn = document.getElementById('ttsBtn');
            const resultDiv = document.getElementById('ttsResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>éŸ³å£°ç”Ÿæˆä¸­...';
            resultDiv.innerHTML = '<div class="result">â³ éŸ³å£°ã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...</div>';

            try {
                const token = document.getElementById('authToken').value.trim();
                if (!token) {
                    throw new Error('èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                }

                const response = await fetch(`${API_BASE}/tts`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text: document.getElementById('ttsText').value,
                        voice: document.getElementById('ttsVoice').value
                        // engine ã‚’æŒ‡å®šã—ãªã„ = è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (Polly/OpenAI)
                    })
                });

                if (!response.ok) {
                    throw new Error(await response.text());
                }

                const blob = await response.blob();
                const url = URL.createObjectURL(blob);
                const size = (blob.size / 1024).toFixed(1);
                
                resultDiv.innerHTML = `
                    <div class="result success">
                        <strong>âœ… éŸ³å£°ç”Ÿæˆå®Œäº†ï¼</strong>
                        <div class="result-content">
                            ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: ${size} KB
                            <audio controls src="${url}" autoplay></audio>
                            <a href="${url}" download="audio.mp3" class="download-btn">ğŸ’¾ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</strong>
                        <div class="result-content">${error.message}</div>
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'ğŸ”Š éŸ³å£°ã‚’ç”Ÿæˆã™ã‚‹';
            }
        }

        async function apiCall(endpoint, data) {
            const token = document.getElementById('authToken').value.trim();
            if (!token) {
                throw new Error('èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
            }

            const response = await fetch(`${API_BASE}${endpoint}`, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${token}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                const text = await response.text();
                throw new Error(text || `HTTP ${response.status}`);
            }

            return response.json();
        }

        async function generateImage() {
            const btn = document.getElementById('imageBtn');
            const resultDiv = document.getElementById('imageResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>ç”»åƒç”Ÿæˆä¸­ (30-60ç§’)...';
            resultDiv.innerHTML = '<div class="result">â³ ç”»åƒã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™ã€‚å°‘ã€…ãŠå¾…ã¡ãã ã•ã„...</div>';

            try {
                const data = await apiCall('/image', {
                    prompt: document.getElementById('imagePrompt').value,
                    model: document.getElementById('imageModel').value,
                    size: document.getElementById('imageSize').value
                });

                const imageUrl = data.images[0].url;
                
                resultDiv.innerHTML = `
                    <div class="result success">
                        <strong>âœ… ç”»åƒç”Ÿæˆå®Œäº†ï¼</strong>
                        <div class="result-content">
                            ãƒ¢ãƒ‡ãƒ«: ${data.model} | ä½¿ç”¨ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ: ${data.credits_used}
                            <img src="${imageUrl}" alt="ç”Ÿæˆã•ã‚ŒãŸç”»åƒ" class="generated-image">
                            <a href="${imageUrl}" target="_blank" class="download-btn">ğŸ”— ãƒ•ãƒ«ã‚µã‚¤ã‚ºã§é–‹ã</a>
                        </div>
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</strong>
                        <div class="result-content">${error.message}</div>
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'ğŸ–¼ï¸ ç”»åƒã‚’ç”Ÿæˆã™ã‚‹';
            }
        }

        async function generateVideo() {
            const btn = document.getElementById('videoBtn');
            const resultDiv = document.getElementById('videoResult');
            
            btn.disabled = true;
            btn.innerHTML = '<span class="loading"></span>å‹•ç”»ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ä¸­...';
            resultDiv.innerHTML = '<div class="result">â³ å‹•ç”»ç”Ÿæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ã„ã¾ã™...</div>';

            try {
                const data = await apiCall('/video', {
                    prompt: document.getElementById('videoPrompt').value,
                    duration: parseInt(document.getElementById('videoDuration').value),
                    mode: 'standard'
                });

                if (data.video_id) {
                    resultDiv.innerHTML = `
                        <div class="result success">
                            <strong>âœ… å‹•ç”»ç”Ÿæˆã‚’é–‹å§‹ã—ã¾ã—ãŸï¼</strong>
                            <div class="result-content">
                                å‹•ç”»ID: ${data.video_id}<br>
                                ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ${data.status}<br>
                                æ¨å®šå®Œäº†æ™‚é–“: ç´„${data.estimated_time}ç§’<br>
                                ä½¿ç”¨ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆ: ${data.credits_used}<br><br>
                                <div id="videoStatus_${data.video_id}">â³ å‡¦ç†ä¸­... 15ç§’å¾Œã«è‡ªå‹•ã§ç¢ºèªã—ã¾ã™</div>
                            </div>
                        </div>
                    `;
                    
                    setTimeout(() => checkVideoStatus(data.video_id), 15000);
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="result error">
                        <strong>âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</strong>
                        <div class="result-content">${error.message}</div>
                    </div>
                `;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'ğŸ¬ å‹•ç”»ã‚’ç”Ÿæˆã™ã‚‹';
            }
        }

        async function checkVideoStatus(videoId) {
            const statusDiv = document.getElementById(`videoStatus_${videoId}`);
            const token = document.getElementById('authToken').value.trim();
            
            try {
                const response = await fetch(`${API_BASE}/video/${videoId}`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                const data = await response.json();
                
                if (data.status === 'completed' && data.url) {
                    statusDiv.innerHTML = `
                        <strong>ğŸ‰ å‹•ç”»ç”Ÿæˆå®Œäº†ï¼</strong><br><br>
                        ${data.thumbnail_url ? `<img src="${data.thumbnail_url}" alt="ã‚µãƒ ãƒã‚¤ãƒ«" style="max-width: 400px; border-radius: 8px; margin-bottom: 10px;">` : ''}
                        <br><a href="${data.url}" target="_blank" class="download-btn">ğŸ¬ å‹•ç”»ã‚’å†ç”Ÿ</a>
                    `;
                } else if (data.status === 'processing' || data.status === 'queued') {
                    statusDiv.innerHTML = `â³ å‡¦ç†ä¸­ (${data.status})... 15ç§’å¾Œã«å†ç¢ºèªã—ã¾ã™`;
                    setTimeout(() => checkVideoStatus(videoId), 15000);
                } else if (data.status === 'failed') {
                    statusDiv.innerHTML = `<strong>âŒ å‹•ç”»ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ</strong>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<strong>âŒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªã‚¨ãƒ©ãƒ¼: ${error.message}</strong>`;
            }
        }
    </script>
</body>
</html>
