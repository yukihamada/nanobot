# つなぎトーク機能（Filler Phrases）

音声会話をより自然にするため、応答に2秒以上かかる場合に「ええっと...」「うーん...」などのつなぎフレーズを自動再生します。

## 仕組み

1. ユーザーが音声で質問
2. 応答に2秒以上かかる場合
3. **つなぎフレーズを再生**（事前キャッシュ済み音声）
4. 本回答が来たらつなぎを停止し、本回答を再生

## つなぎフレーズ一覧

### 日本語
- 「ええっと、それはですね」
- 「うーん、ちょっと考えますね」
- 「なるほど、それでは」
- 「そうですね、まず」
- 「いい質問ですね」
- 「ちょっと待ってくださいね」
- 「えーっと、どうだったかな」

### 英語
- "Let me think about that"
- "Hmm, that's interesting"
- "Well, let's see"
- "Good question"
- "One moment please"

## 音声ファイル生成

つなぎフレーズの音声ファイルを事前生成します：

```bash
# OpenAI API キーを設定
export OPENAI_API_KEY=sk-...

# 音声ファイル生成（約7-12個、合計数百KB）
node scripts/generate-filler-audio.js
```

生成されるファイル:
```
web/audio/fillers/
  ├── manifest.json        # フレーズ一覧
  ├── ja-01-eetto.mp3      # 「ええっと...」
  ├── ja-02-uun.mp3        # 「うーん...」
  ├── ja-03-naruhodo.mp3   # 「なるほど...」
  ├── ...
  ├── en-01-think.mp3      # "Let me think..."
  └── en-02-hmm.mp3        # "Hmm..."
```

## 動作確認

1. 音声ファイルを生成
2. ブラウザで chatweb.ai を開く
3. マイクボタンで音声入力
4. 応答が2秒以上かかると、つなぎフレーズが再生される

## 実装詳細

- **キャッシング**: 音声ファイルはブラウザキャッシュに保存（即座に再生可能）
- **ランダム選択**: 同じフレーズの繰り返しを避ける
- **音声入力のみ**: テキスト入力時はつなぎフレーズを再生しない
- **自動停止**: 本回答が来たら即座につなぎを停止

## 将来の拡張

- [ ] カスタムフレーズ追加（設定画面）
- [ ] 感情に応じたフレーズ選択（質問の種類で変える）
- [ ] ストリーミングTTS（つなぎ→200文字→本回答）
- [ ] 複数モデル並行実行中の進捗表示
